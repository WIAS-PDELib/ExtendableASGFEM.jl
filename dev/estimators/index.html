<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>A posteriori error estimation · ExtendableASGFEM.jl</title><meta name="title" content="A posteriori error estimation · ExtendableASGFEM.jl"/><meta property="og:title" content="A posteriori error estimation · ExtendableASGFEM.jl"/><meta property="twitter:title" content="A posteriori error estimation · ExtendableASGFEM.jl"/><meta name="description" content="Documentation for ExtendableASGFEM.jl."/><meta property="og:description" content="Documentation for ExtendableASGFEM.jl."/><meta property="twitter:description" content="Documentation for ExtendableASGFEM.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ExtendableASGFEM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">KLE expansions</span><ul><li><a class="tocitem" href="../coefficients/">Stochastic Coefficients</a></li></ul></li><li><span class="tocitem">Stochastic discretization</span><ul><li><a class="tocitem" href="../orthogonal_polynomials/">Orthogonal Polynomials</a></li><li><a class="tocitem" href="../onbasis/">ONBasis</a></li><li><a class="tocitem" href="../tonbasis/">TensorizedBasis</a></li></ul></li><li><span class="tocitem">Solvers</span><ul><li><a class="tocitem" href="../sgfevector/">SGFEVector</a></li><li><a class="tocitem" href="../modelproblems/">Model Problems</a></li></ul></li><li><span class="tocitem">Adaptivity</span><ul><li class="is-active"><a class="tocitem" href>A posteriori error estimation</a><ul class="internal"><li><a class="tocitem" href="#Residual-based-error-estimation"><span>Residual-based error estimation</span></a></li><li><a class="tocitem" href="#Multi-index-management"><span>Multi index management</span></a></li><li><a class="tocitem" href="#Monte-carlo-sampling-estimator"><span>Monte carlo sampling estimator</span></a></li></ul></li></ul></li><li><span class="tocitem">Plotting</span><ul><li><a class="tocitem" href="../plots/">Plotting</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Adaptivity</a></li><li class="is-active"><a href>A posteriori error estimation</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>A posteriori error estimation</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/master/docs/src/estimators.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="A-posteriori-error-estimation"><a class="docs-heading-anchor" href="#A-posteriori-error-estimation">A posteriori error estimation</a><a id="A-posteriori-error-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#A-posteriori-error-estimation" title="Permalink"></a></h1><h2 id="Residual-based-error-estimation"><a class="docs-heading-anchor" href="#Residual-based-error-estimation">Residual-based error estimation</a><a id="Residual-based-error-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Residual-based-error-estimation" title="Permalink"></a></h2><p>Spatial error estimation refers to classical residual-based error estimation for the zero-th multi index that refers to the mean value. Stochastic error control has to estimate which stochastic mode needs to be refined in the sense that either the polynomial degree is increased or neighbouring stochastic modes are activated. Both is represented by the multi-indices. Then unified error control allows to perform residual-based error estimation for the subresiduals that are associated to each multi-index (see references on the main page for details).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.estimate-Tuple{Type{ExtendableASGFEM.AbstractModelProblem}, SGFEVector, AbstractStochasticCoefficient}" href="#ExtendableASGFEM.estimate-Tuple{Type{ExtendableASGFEM.AbstractModelProblem}, SGFEVector, AbstractStochasticCoefficient}"><code>ExtendableASGFEM.estimate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimate(
    ::Type{ExtendableASGFEM.AbstractModelProblem},
    sol::SGFEVector,
    C::AbstractStochasticCoefficient;
    kwargs...
) -&gt; Tuple{DataType, DataType, Vector{Vector{Int64}}}
</code></pre><p>computes the residual-based a posteriori error estimator for the current solution vector <code>sol</code> for the given model problem and stochastic coefficient <code>C</code> and returns:</p><ul><li><code>eta4modes</code> = array with total error estimators for each multi-index (corresponding to the enriched set of multi-indices with the current active modes coming first)</li><li><code>eta4cell</code> = array with total error estimators for each cell in grid (for spatial refinement)</li><li>`multi<em>indices</em>extended = enriched set of multi-indices used for the computations</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/8f27eabf94c3e614adb9221cf6044b8f694f1398/src/estimate.jl#L38">source</a></section></article><h2 id="Multi-index-management"><a class="docs-heading-anchor" href="#Multi-index-management">Multi index management</a><a id="Multi-index-management-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-index-management" title="Permalink"></a></h2><p>Depending on the model problem and stochastic coefficient the amount of multi indices that should be added to the error estimation varies. Here are some methods that help with enriching the set of multi-indices.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.add_boundary_modes-Tuple{Any}" href="#ExtendableASGFEM.add_boundary_modes-Tuple{Any}"><code>ExtendableASGFEM.add_boundary_modes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_boundary_modes(
    multi_indices;
    p_extension,
    tail_extension
) -&gt; Any
</code></pre><p>adds new stochastic modes:</p><ul><li>for each existing mode all neighbouring modes are added (= all possible copies of that mode where one dimension is increased by 1)</li><li>`p_extension&#39; additionally ensures that the polynomial degree of the first dimension is increased by this amount</li><li>`tail<em>extension&#39; activates tail</em>expansion[1] many new stochastic modes with order 1,  for each existing mode also the next tail_expansion[2] many higher stochastic modes are activated or increased</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/8f27eabf94c3e614adb9221cf6044b8f694f1398/src/mopcontrol.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.classify_modes" href="#ExtendableASGFEM.classify_modes"><code>ExtendableASGFEM.classify_modes</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">classify_modes(multi_indices) -&gt; NTuple{5, Vector{Int64}}
classify_modes(
    multi_indices,
    active_modes
) -&gt; NTuple{5, Vector{Int64}}
</code></pre><p>classifies all multi indices into these categories:</p><ul><li><code>active_int</code> = mode and all its direct neighbours (+1 in all active and the next dimensions) are in active_modes</li><li><code>active_bnd</code> = mode but not all its direct neighbours are in active_modes</li><li><code>inactive_bnd</code> = inactive mode that has an active neighbour</li><li><code>inactive_bnd2</code> = inactive mode that has an neighbour in inactive_bnd </li><li><code>inactive_else</code> = all other</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/8f27eabf94c3e614adb9221cf6044b8f694f1398/src/mopcontrol.jl#L137">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.generate_multiindices-Tuple{Any, Any}" href="#ExtendableASGFEM.generate_multiindices-Tuple{Any, Any}"><code>ExtendableASGFEM.generate_multiindices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_multiindices(M, deg) -&gt; Any
</code></pre><p>generates multi-indices for <code>M</code> dimensions up to degree <code>deg</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/8f27eabf94c3e614adb9221cf6044b8f694f1398/src/mopcontrol.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.prepare_multi_indices!-Tuple{Any}" href="#ExtendableASGFEM.prepare_multi_indices!-Tuple{Any}"><code>ExtendableASGFEM.prepare_multi_indices!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_multi_indices!(multi_indices; minimal_length)
</code></pre><p>ensures that all multi-indices have the same length</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/8f27eabf94c3e614adb9221cf6044b8f694f1398/src/mopcontrol.jl#L24">source</a></section></article><h2 id="Monte-carlo-sampling-estimator"><a class="docs-heading-anchor" href="#Monte-carlo-sampling-estimator">Monte carlo sampling estimator</a><a id="Monte-carlo-sampling-estimator-1"></a><a class="docs-heading-anchor-permalink" href="#Monte-carlo-sampling-estimator" title="Permalink"></a></h2><p>There is also a hierarchical Monte carlo error estimator available that compares the solution with a higher order discrete solution for sampled deterministic problems. This is merely intended as a way to compute the reference error to assess the efficiency of the residual-based error estimator.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.calculate_sampling_error-Tuple{SGFEVector, AbstractStochasticCoefficient}" href="#ExtendableASGFEM.calculate_sampling_error-Tuple{SGFEVector, AbstractStochasticCoefficient}"><code>ExtendableASGFEM.calculate_sampling_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_sampling_error(
    SolutionSGFEM::SGFEVector,
    C::AbstractStochasticCoefficient;
    problem,
    bonus_quadorder_a,
    bonus_quadorder_f,
    order,
    rhs,
    dim,
    Msamples,
    parallel_sampling,
    dimensionwise_error,
    energy_norm,
    debug,
    nsamples
) -&gt; NTuple{4, Vector{Float64}}
</code></pre><p>estimates the error for the model problem <code>problem</code> by Monte carlo sampling: for each sample a discrete finite element solution of the deterministic model problem with fixed (sampled) coefficient with polynomial order <code>order</code> is computed and compared to the given stochastic Galerkin solution <code>SolutionSGFEM</code>. Return values are:</p><ul><li>totalerrorL2stress_weighted : mean L2 error of the stress with samples weighted by the distribution</li><li>totalerrorL2u_weighted : mean L2 error with samples weighted by the distribution</li><li>totalerrorL2stress_uniform : mean L2 error of the stress with samples weighted uniformly</li><li>totalerrorL2u_uniform : mean L2 error with samples weighted uniformly</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/8f27eabf94c3e614adb9221cf6044b8f694f1398/src/sampling_error.jl#L51">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../modelproblems/">« Model Problems</a><a class="docs-footer-nextpage" href="../plots/">Plotting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.11.4 on <span class="colophon-date" title="Friday 16 May 2025 17:17">Friday 16 May 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
