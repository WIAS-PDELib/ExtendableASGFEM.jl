<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Adaptivity and error control · ExtendableASGFEM.jl</title><meta name="title" content="Adaptivity and error control · ExtendableASGFEM.jl"/><meta property="og:title" content="Adaptivity and error control · ExtendableASGFEM.jl"/><meta property="twitter:title" content="Adaptivity and error control · ExtendableASGFEM.jl"/><meta name="description" content="Documentation for ExtendableASGFEM.jl."/><meta property="og:description" content="Documentation for ExtendableASGFEM.jl."/><meta property="twitter:description" content="Documentation for ExtendableASGFEM.jl."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">ExtendableASGFEM.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><span class="tocitem">Model problems</span><ul><li><a class="tocitem" href="../modelproblems/">Model Problems</a></li><li><a class="tocitem" href="../coefficients/">Stochastic Coefficients</a></li></ul></li><li><span class="tocitem">Stochastic discretization</span><ul><li><a class="tocitem" href="../orthogonal_polynomials/">Orthogonal Polynomials</a></li><li><a class="tocitem" href="../onbasis/">ONBasis</a></li><li><a class="tocitem" href="../tonbasis/">TensorizedBasis</a></li></ul></li><li><span class="tocitem">Solving</span><ul><li><a class="tocitem" href="../solvers/">Solver</a></li><li class="is-active"><a class="tocitem" href>Adaptivity and error control</a><ul class="internal"><li><a class="tocitem" href="#Residual-based-a-posteriori-error-estimation"><span>Residual-based a posteriori error estimation</span></a></li><li><a class="tocitem" href="#Multi-index-management"><span>Multi-index management</span></a></li><li><a class="tocitem" href="#Monte-Carlo-sampling-estimator"><span>Monte Carlo sampling estimator</span></a></li></ul></li></ul></li><li><span class="tocitem">Plotting</span><ul><li><a class="tocitem" href="../plots/">Plotting</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Solving</a></li><li class="is-active"><a href>Adaptivity and error control</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Adaptivity and error control</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/master/docs/src/estimators.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Adaptivity-and-error-control"><a class="docs-heading-anchor" href="#Adaptivity-and-error-control">Adaptivity and error control</a><a id="Adaptivity-and-error-control-1"></a><a class="docs-heading-anchor-permalink" href="#Adaptivity-and-error-control" title="Permalink"></a></h1><h2 id="Residual-based-a-posteriori-error-estimation"><a class="docs-heading-anchor" href="#Residual-based-a-posteriori-error-estimation">Residual-based a posteriori error estimation</a><a id="Residual-based-a-posteriori-error-estimation-1"></a><a class="docs-heading-anchor-permalink" href="#Residual-based-a-posteriori-error-estimation" title="Permalink"></a></h2><p>Spatial error estimation refers to classical residual-based error estimation for the zero-th multi-index, which corresponds to the mean value. Stochastic error control determines which stochastic mode should be refined, either by increasing the polynomial degree or by activating neighboring stochastic modes. Both are represented by multi-indices. Unified error control enables residual-based error estimation for the subresiduals associated with each multi-index, depending on the model problem (see references on the main page for details).</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.estimate-Tuple{Type{ExtendableASGFEM.AbstractModelProblem}, SGFEVector, AbstractStochasticCoefficient}" href="#ExtendableASGFEM.estimate-Tuple{Type{ExtendableASGFEM.AbstractModelProblem}, SGFEVector, AbstractStochasticCoefficient}"><code>ExtendableASGFEM.estimate</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">estimate(
    ::Type{ExtendableASGFEM.AbstractModelProblem},
    sol::SGFEVector,
    C::AbstractStochasticCoefficient;
    kwargs...
) -&gt; Tuple{DataType, DataType, Vector{Vector{Int64}}}
</code></pre><p>Compute the residual-based a posteriori error estimator for a stochastic Galerkin solution vector <code>sol</code>.</p><p><strong>Arguments</strong></p><ul><li><code>::Type{AbstractModelProblem}</code>: The model problem type for which the estimator is called. Used for dispatching to the appropriate estimator implementation.</li><li><code>sol::SGFEVector</code>: The current stochastic Galerkin solution vector.</li><li><code>C::AbstractStochasticCoefficient</code>: The stochastic coefficient (random field or parameterization).</li><li><code>rhs</code>: (Optional) Right-hand side function for the PDE (default: <code>nothing</code>).</li><li><code>bonus_quadorder</code>: (Optional) Additional quadrature order for integration (default: 1).</li><li><code>tail_extension</code>: (Optional) Number of additional boundary modes to include in the multi-index set (default: 5).</li><li><code>kwargs...</code>: Additional keyword arguments passed to the estimator.</li></ul><p><strong>Returns</strong></p><p>A tuple containing:</p><ul><li><code>eta4modes::Vector{Float64}</code>: Total error estimator for each multi-index (stochastic mode), corresponding to the enriched set of multi-indices (with current active modes first).</li><li><code>eta4cell::Matrix{Float64}</code>: Error estimator for each cell in the spatial grid (for spatial refinement), for each multi-index.</li><li><code>multi_indices_extended</code>: The enriched set of multi-indices used in the computation (including boundary extensions).</li></ul><p><strong>Description</strong></p><p>This function computes a residual-based a posteriori error estimator for the current SGFEM solution. It supports both spatial and stochastic adaptivity by providing error indicators for each cell and each stochastic mode. The estimator is tailored to the model problem and the stochastic coefficient, and can be extended to include additional boundary modes for improved reliability.</p><p>If no specialized estimator is available for the given model problem type, an error is raised and empty arrays are returned. ```</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/bcfd568774836bf134579247c65ce818440bfc9d/src/estimate.jl#L38">source</a></section></article><h2 id="Multi-index-management"><a class="docs-heading-anchor" href="#Multi-index-management">Multi-index management</a><a id="Multi-index-management-1"></a><a class="docs-heading-anchor-permalink" href="#Multi-index-management" title="Permalink"></a></h2><p>Depending on the model problem and stochastic coefficient, the number of multi-indices to be added for error estimation varies. The following methods assist in enriching the set of multi-indices.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.add_boundary_modes-Tuple{Any}" href="#ExtendableASGFEM.add_boundary_modes-Tuple{Any}"><code>ExtendableASGFEM.add_boundary_modes</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">add_boundary_modes(
    multi_indices;
    p_extension,
    tail_extension
) -&gt; Any
</code></pre><p>Adds new stochastic modes (multi-indices) to the current set by extending in several ways:</p><ul><li>For each existing mode, all neighboring modes are added (i.e., all possible copies of that mode where one dimension is increased by 1).</li><li><code>p_extension</code> ensures that the polynomial degree in the first dimension is increased by this amount (adds new modes with higher degree in the first component).</li><li><code>tail_extension</code> is a two-element vector:<ul><li><code>tail_extension[1]</code>: Adds this many new modes of order 1 (i.e., with a single nonzero entry).</li><li><code>tail_extension[2]</code>: For each existing mode, also activates or increases the next <code>tail_extension[2]</code> higher stochastic modes in each dimension.</li></ul></li></ul><p>Returns the extended set of multi-indices.</p><p><strong>Arguments</strong></p><ul><li><code>multi_indices</code>: The current set of multi-indices (vector of integer vectors).</li><li><code>p_extension</code>: Number of additional degrees to add in the first dimension (default: 1).</li><li><code>tail_extension</code>: Two-element vector controlling the number and type of new modes to add (default: <code>[10, 2]</code>).</li></ul><p><strong>Returns</strong></p><p>A new vector containing the extended set of multi-indices.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/bcfd568774836bf134579247c65ce818440bfc9d/src/mopcontrol.jl#L39">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.classify_modes" href="#ExtendableASGFEM.classify_modes"><code>ExtendableASGFEM.classify_modes</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">classify_modes(multi_indices) -&gt; NTuple{5, Vector{Int64}}
classify_modes(
    multi_indices,
    active_modes
) -&gt; NTuple{5, Vector{Int64}}
</code></pre><p>Classifies all multi-indices into the following categories based on their neighborhood relations:</p><ul><li><code>active_int</code>: Active mode where all direct neighbors (obtained by increasing any active or next dimension by 1) are also in <code>active_modes</code>.</li><li><code>active_bnd</code>: Active mode where not all direct neighbors are in <code>active_modes</code> (i.e., it lies on the active boundary).</li><li><code>inactive_bnd</code>: Inactive mode that has at least one active neighbor (first layer of inactive modes).</li><li><code>inactive_bnd2</code>: Inactive mode that has a neighbor in <code>inactive_bnd</code> (second layer of inactive modes).</li><li><code>inactive_else</code>: All other inactive modes.</li></ul><p><strong>Arguments</strong></p><ul><li><code>multi_indices</code>: The set of all multi-indices to classify (vector of integer vectors).</li><li><code>active_modes</code>: The set of currently active modes (default: all <code>multi_indices</code>).</li></ul><p><strong>Returns</strong></p><p>A tuple of five vectors containing the indices of the multi-indices in the following order: <code>(inactive_else, inactive_bnd, inactive_bnd2, active_bnd, active_int)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/bcfd568774836bf134579247c65ce818440bfc9d/src/mopcontrol.jl#L149">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.generate_multiindices-Tuple{Any, Any}" href="#ExtendableASGFEM.generate_multiindices-Tuple{Any, Any}"><code>ExtendableASGFEM.generate_multiindices</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">generate_multiindices(M, deg) -&gt; Any
</code></pre><p>generates multi-indices for <code>M</code> dimensions up to degree <code>deg</code></p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/bcfd568774836bf134579247c65ce818440bfc9d/src/mopcontrol.jl#L1">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.prepare_multi_indices!-Tuple{Any}" href="#ExtendableASGFEM.prepare_multi_indices!-Tuple{Any}"><code>ExtendableASGFEM.prepare_multi_indices!</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">prepare_multi_indices!(multi_indices; minimal_length)
</code></pre><p>ensures that all multi-indices have the same length</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/bcfd568774836bf134579247c65ce818440bfc9d/src/mopcontrol.jl#L24">source</a></section></article><h2 id="Monte-Carlo-sampling-estimator"><a class="docs-heading-anchor" href="#Monte-Carlo-sampling-estimator">Monte Carlo sampling estimator</a><a id="Monte-Carlo-sampling-estimator-1"></a><a class="docs-heading-anchor-permalink" href="#Monte-Carlo-sampling-estimator" title="Permalink"></a></h2><p>A hierarchical Monte Carlo error estimator is also available. It compares the solution with a higher-order discrete solution for sampled deterministic problems. This is mainly intended to compute a reference error to assess the efficiency of the residual-based error estimator.</p><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="ExtendableASGFEM.calculate_sampling_error-Tuple{SGFEVector, AbstractStochasticCoefficient}" href="#ExtendableASGFEM.calculate_sampling_error-Tuple{SGFEVector, AbstractStochasticCoefficient}"><code>ExtendableASGFEM.calculate_sampling_error</code></a> — <span class="docstring-category">Method</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">calculate_sampling_error(
    SolutionSGFEM::SGFEVector,
    C::AbstractStochasticCoefficient;
    problem,
    bonus_quadorder_a,
    bonus_quadorder_f,
    order,
    rhs,
    dim,
    Msamples,
    parallel_sampling,
    dimensionwise_error,
    energy_norm,
    debug,
    nsamples
) -&gt; NTuple{4, Vector{Float64}}
</code></pre><p>Estimates the error for the given model problem by Monte Carlo sampling. For each sample, a deterministic finite element solution is computed for a fixed (sampled) coefficient with polynomial order <code>order</code> and compared to the provided stochastic Galerkin solution <code>SolutionSGFEM</code>.</p><p><strong>Returns</strong></p><p>A tuple of arrays (each of length <code>M+1</code>, where <code>M</code> is the maximum order of the multi-indices):</p><ul><li><code>totalerrorL2stress_weighted</code>: Mean L2 error of the stress, weighted by the distribution.</li><li><code>totalerrorL2u_weighted</code>: Mean L2 error of the solution, weighted by the distribution.</li><li><code>totalerrorL2stress_uniform</code>: Mean L2 error of the stress, weighted uniformly.</li><li><code>totalerrorL2u_uniform</code>: Mean L2 error of the solution, weighted uniformly.</li></ul><p>The m-th component of these arrays gives the error when only multi-indices up to order m are included.</p><p><strong>Arguments</strong></p><ul><li><code>SolutionSGFEM</code>: The stochastic Galerkin solution (SGFEVector).</li><li><code>C</code>: The stochastic coefficient.</li><li><code>problem</code>: The model problem type (default: <code>LogTransformedPoissonProblemPrimal</code>).</li><li><code>bonus_quadorder_a</code>: Additional quadrature order for the coefficient (default: 10).</li><li><code>bonus_quadorder_f</code>: Additional quadrature order for the right-hand side (default: 0).</li><li><code>order</code>: Polynomial order for the deterministic reference solution (default: 2).</li><li><code>rhs</code>: Right-hand side function (optional).</li><li><code>dim</code>: Spatial dimension (default: inferred from the solution).</li><li><code>Msamples</code>: Number of random variables to sample (default: <code>maxm(C)</code>).</li><li><code>parallel_sampling</code>: Whether to use parallel sampling (default: true).</li><li><code>dimensionwise_error</code>: If true, computes errors dimensionwise (default: false).</li><li><code>energy_norm</code>: If true, uses the energy norm for stress error (default: true).</li><li><code>debug</code>: If true, enables debug output and plotting (default: false).</li><li><code>nsamples</code>: Number of Monte Carlo samples (default: 100).</li></ul><p><strong>Details</strong></p><p>This function computes deterministic reference solutions for each sample, then compares them to the SGFEM solution to estimate the error. Both weighted and unweighted (uniform) averages are returned for stress and solution errors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/WIAS-PDELib/ExtendableASGFEM.jl/blob/bcfd568774836bf134579247c65ce818440bfc9d/src/sampling_error.jl#L51">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../solvers/">« Solver</a><a class="docs-footer-nextpage" href="../plots/">Plotting »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.13.0 on <span class="colophon-date" title="Tuesday 8 July 2025 16:22">Tuesday 8 July 2025</span>. Using Julia version 1.11.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
